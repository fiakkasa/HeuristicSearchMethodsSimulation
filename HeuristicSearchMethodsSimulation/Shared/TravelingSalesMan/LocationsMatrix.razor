<Condition Evaluation="Matrix?.Count > 1">
    <Match>
        <div class="traveling-salesman-matrix-container @CssClass">
            <h4>Matrix</h4>

            <div class="table-responsive">
                <table class="table table-striped m-0">
                    <thead>
                        <tr>
                            <th>Distance (Km)</th>
                            <Iterations T="string" Items="Matrix![0].Xlabels">
                                <th>@context</th>
                            </Iterations>
                        </tr>
                    </thead>
                    <tbody>
                        <Iterations T="LocationRow" Items="Matrix">
                            <tr>
                                <th>@context.Ylabel</th>
                                <Iterations T="LocationToLocation" Items="context.Collection" Context="childContext">
                                    <td class="@CellCssClass(context, childContext)">
                                        @childContext.DistanceInKilometers.ToString("0,")
                                    </td>
                                </Iterations>
                            </tr>
                        </Iterations>
                    </tbody>
                </table>
            </div>
            <NumberOfUniqueLocations Value="NumberOfUniqueRoutes" CssClass="mt-2" />
        </div>
    </Match>
</Condition>

@code {
    [Parameter] public string? CssClass { get; set; }
    [Parameter] public List<LocationRow>? Matrix { get; set; }
    [Parameter] public long NumberOfUniqueRoutes { get; set; } = 0L;

    private string CellCssClass(LocationRow row, LocationToLocation cell) => (
        (row, cell) switch
        {
            { row: { Min: { } }, cell: _ } when row.Min.Key == cell.Key => "min-distance text-success",
            { row: { Max: { } }, cell: _ } when row.Max.Key == cell.Key => "max-distance text-danger",
            { row: _, cell: { DistanceInKilometers: 0 } } => "text-muted",
            _ => string.Empty
        } + $" ordinal-from-origin-{cell.OrdinalFromOrigin}"
    ).Trim();
}
